<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Анатомия Сети: Интерактивная Лекция</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            black: '#050505',
                            dark: '#121212',
                            gray: '#1a1a1a',
                            light: '#e0e0e0',
                            neon: '#deff9a',
                            alert: '#ff6b6b',
                            dim: '#bbbbbb',
                            blue: '#4cc9f0'
                        }
                    },
                    fontFamily: {
                        sans: ['Urbanist', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    animation: {
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <style>
        /* Base Reset */
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #050505;
            overscroll-behavior: none;
        }

        body {
            background-color: #050505;
            color: #e0e0e0;
            overflow: hidden; /* Prevent document scroll; scroll inside slides */
            touch-action: pan-y; /* Allow vertical scroll/swipe */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

/* Hide Scrollbar but allow scroll */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .slide {
            height: 100dvh;
            width: 100vw;
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align top for scrollable content */
            align-items: center;
            padding: 1.5rem; /* Reduced padding for mobile */
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            opacity: 0;
            pointer-events: none;
            z-index: 0;
            background-color: #050505;
            overflow-y: auto; /* Allow internal scrolling */
            overflow-x: hidden;
        }

        
        @supports not (height: 100dvh) {
            .slide { height: 100vh; }
        }
/* Desktop centering adjustment */
        @media (min-width: 768px) {
            .slide {
                justify-content: center;
                padding: 2rem;
            }
        }

        .slide.active { opacity: 1; pointer-events: auto; z-index: 10; transform: translateY(0); }
        .slide.prev { opacity: 0; transform: translateY(-100vh); pointer-events: none; }
        .slide.next { opacity: 0; transform: translateY(100vh); pointer-events: none; }

        .chart-container { position: relative; width: 100%; height: 250px; margin: 0 auto; }
        @media (min-width: 768px) { .chart-container { height: 300px; max-width: 600px; } }

        .nav-btn { backdrop-filter: blur(5px); transition: all 0.3s ease; cursor: pointer; }
        .nav-btn:hover { background-color: rgba(222, 255, 154, 0.2); color: #deff9a; }
        
        /* Slide Number Style */
        .slide-number {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            color: #444;
            pointer-events: none;
            z-index: 20;
        }
        .slide.active .slide-number {
            color: #deff9a;
            transition: color 1s ease;
        }
        @media (min-width: 768px) { .slide-number { bottom: 2rem; left: 2rem; font-size: 1.5rem; } }

        /* Specific OSI Styles */
        .osi-card {
            transition: all 0.3s ease;
        }
        .osi-btn {
            cursor: pointer;
            white-space: nowrap; /* Prevent text wrap in horizontal scroll */
        }
        
        /* Mobile horizontal scroll for OSI buttons */
        .osi-nav-container {
            -webkit-overflow-scrolling: touch;
        }

        /* Infographic helpers (Slide 4) */
        .flowline {
            height: 3px;
            border-radius: 999px;
            background: rgba(255,255,255,.10);
            position: relative;
            overflow: hidden;
        }
        .flowline::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(34,211,238,.45), transparent);
            transform: translateX(-60%);
            animation: flowMove 1.8s linear infinite;
        }
        @keyframes flowMove { to { transform: translateX(60%); } }

        .tag {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,.10);
            background: rgba(0,0,0,.45);
            color: rgba(255,255,255,.65);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }


    </style>
</head>
<body class="bg-cyber-black text-cyber-light font-sans selection:bg-cyber-neon selection:text-cyber-black">

    <!-- Navigation Overlay (Fixed) -->
    <div class="fixed bottom-4 right-4 z-50 flex gap-3 md:bottom-8 md:right-8 md:gap-4">
        <button type="button" data-slide-dir="-1" class="nav-btn w-10 h-10 md:w-12 md:h-12 rounded-full border border-cyber-neon/30 text-cyber-neon flex items-center justify-center active:scale-95 md:hover:scale-110 bg-black/50" title="Вверх/Назад">
            <i class="fa-solid fa-arrow-up"></i>
        </button>
        <button type="button" data-slide-dir="1" class="nav-btn w-10 h-10 md:w-12 md:h-12 rounded-full border border-cyber-neon/30 text-cyber-neon flex items-center justify-center active:scale-95 md:hover:scale-110 bg-black/50" title="Вниз/Далее">
            <i class="fa-solid fa-arrow-down"></i>
        </button>
    </div>

    <!-- Progress Bar (Top) -->
    <div class="fixed top-0 left-0 w-full h-1 bg-cyber-gray z-50">
        <div id="progress-bar" class="h-full bg-cyber-neon transition-all duration-300" style="width: 0%"></div>
    </div>

    <!-- Slide Number Indicator -->
    <div class="slide-number z-50"><span id="current-slide-num">01</span> / <span id="total-slide-num">00</span></div>

    <!-- ================= SLIDES ================= -->

    <!-- SLIDE 0: Title -->
    <section class="slide active bg-cyber-black no-scrollbar" id="slide-0">
        <div class="absolute inset-0 z-0 opacity-20 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-cyber-neon/20 via-transparent to-transparent pointer-events-none"></div>
        <div class="z-10 text-center w-full max-w-4xl flex flex-col justify-center min-h-full">
            <div class="mb-4 md:mb-6 inline-block px-3 py-1 border border-cyber-neon rounded-full text-cyber-neon text-xs md:text-sm uppercase tracking-widest self-center">
                Лекция / Семинар
            </div>
            <h1 class="text-4xl md:text-6xl lg:text-8xl font-bold mb-4 md:mb-6 leading-tight">
                Анатомия <span class="text-cyber-neon">Сети</span>
            </h1>
            <p class="text-lg md:text-2xl text-cyber-dim mb-8 md:mb-12 px-4">
                Как работает интернет, где живут уязвимости, и как государство контролирует трафик.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 text-left w-full px-2">
                <div class="p-4 border border-white/10 rounded-lg bg-white/5 backdrop-blur-sm">
                    <i class="fa-solid fa-layer-group text-cyber-neon text-xl md:text-2xl mb-2"></i>
                    <h3 class="font-bold text-base md:text-lg">База (OSI)</h3>
                    <p class="text-xs md:text-sm text-gray-400">От кабеля до браузера</p>
                </div>
                <div class="p-4 border border-white/10 rounded-lg bg-white/5 backdrop-blur-sm">
                    <i class="fa-solid fa-user-secret text-cyber-alert text-xl md:text-2xl mb-2"></i>
                    <h3 class="font-bold text-base md:text-lg">Угрозы</h3>
                    <p class="text-xs md:text-sm text-gray-400">Wi-Fi, 2G, СОРМ</p>
                </div>
                <div class="p-4 border border-white/10 rounded-lg bg-white/5 backdrop-blur-sm">
                    <i class="fa-solid fa-ban text-cyber-alert text-xl md:text-2xl mb-2"></i>
                    <h3 class="font-bold text-base md:text-lg">Цензура</h3>
                    <p class="text-xs md:text-sm text-gray-400">ТСПУ и замедление</p>
                </div>
            </div>
            <p class="mt-8 md:mt-12 text-xs md:text-sm text-gray-500 font-mono animate-pulse">Свайп вверх или нажми ↓</p>
        </div>
    </section>

    <!-- SLIDE 1: OSI Model Interactive -->
    <section class="slide bg-cyber-dark no-scrollbar" id="slide-1">
        <div class="w-full max-w-7xl flex flex-col h-full pt-4 md:justify-center">
            <h2 class="text-2xl md:text-4xl font-bold mb-4 md:mb-8 text-cyber-neon border-l-4 border-cyber-neon pl-4 shrink-0">
                Модель OSI
            </h2>
            
            <div class="flex flex-col md:grid md:grid-cols-12 gap-4 md:gap-6 h-full md:h-[75vh]">
                <!-- Layer Navigation (Horizontal Scroll on Mobile, Vertical on Desktop) -->
                <div class="md:col-span-3 flex md:flex-col-reverse gap-2 overflow-x-auto md:overflow-x-hidden md:overflow-y-auto pb-2 md:pb-0 osi-nav-container shrink-0 no-scrollbar">
                    <button type="button" data-osi-layer="1" id="osi-btn-1" class="osi-btn p-2 md:p-3 border border-white/20 rounded hover:bg-white/10 text-left transition-all flex justify-between items-center group min-w-[140px] md:min-w-0">
                        <span class="font-mono font-bold text-sm md:text-lg">1. Физический</span>
                        <i class="fa-solid fa-network-wired opacity-50 group-hover:opacity-100 hidden md:block"></i>
                    </button>
                    <button type="button" data-osi-layer="2" id="osi-btn-2" class="osi-btn p-2 md:p-3 border border-white/20 rounded hover:bg-white/10 text-left transition-all flex justify-between items-center group min-w-[140px] md:min-w-0">
                        <span class="font-mono font-bold text-sm md:text-lg">2. Канальный</span>
                        <i class="fa-solid fa-ethernet opacity-50 group-hover:opacity-100 hidden md:block"></i>
                    </button>
                    <button type="button" data-osi-layer="3" id="osi-btn-3" class="osi-btn p-2 md:p-3 border border-white/20 rounded hover:bg-white/10 text-left transition-all flex justify-between items-center group min-w-[140px] md:min-w-0">
                        <span class="font-mono font-bold text-sm md:text-lg">3. Сетевой</span>
                        <i class="fa-solid fa-globe opacity-50 group-hover:opacity-100 hidden md:block"></i>
                    </button>
                    <button type="button" data-osi-layer="4" id="osi-btn-4" class="osi-btn p-2 md:p-3 border border-white/20 rounded hover:bg-white/10 text-left transition-all flex justify-between items-center group min-w-[140px] md:min-w-0">
                        <span class="font-mono font-bold text-sm md:text-lg">4. Транспортный</span>
                        <i class="fa-solid fa-truck-fast opacity-50 group-hover:opacity-100 hidden md:block"></i>
                    </button>
                    <button type="button" data-osi-layer="5" id="osi-btn-5" class="osi-btn p-2 md:p-3 border border-white/20 rounded hover:bg-white/10 text-left transition-all flex justify-between items-center group min-w-[140px] md:min-w-0">
                        <span class="font-mono font-bold text-sm md:text-lg">5. Сеансовый</span>
                        <i class="fa-solid fa-handshake opacity-50 group-hover:opacity-100 hidden md:block"></i>
                    </button>
                    <button type="button" data-osi-layer="6" id="osi-btn-6"
                    class="osi-btn p-2 md:p-3 border border-white/20 rounded hover:bg-white/10 text-left transition-all
                            flex justify-between items-center group min-w-[140px] md:min-w-0 overflow-hidden">
                    <span class="font-mono font-bold text-sm md:text-lg leading-tight whitespace-normal break-words">
                        6. Представительский
                    </span>
                    <i class="fa-solid fa-language opacity-50 group-hover:opacity-100 hidden md:block"></i>
                    </button>
                    <button type="button" data-osi-layer="7" id="osi-btn-7" class="osi-btn p-2 md:p-3 border border-white/20 rounded hover:bg-white/10 text-left transition-all flex justify-between items-center group min-w-[140px] md:min-w-0">
                        <span class="font-mono font-bold text-sm md:text-lg">7. Прикладной</span>
                        <i class="fa-brands fa-chrome opacity-50 group-hover:opacity-100 hidden md:block"></i>
                    </button>
                </div>

                <!-- Info Panel -->
                <div class="md:col-span-9 bg-cyber-gray border border-white/10 rounded-xl p-4 md:p-6 flex flex-col relative overflow-hidden h-full">
                    <div class="absolute top-0 right-0 p-4 opacity-10">
                        <i id="osi-big-icon" class="fa-solid text-6xl md:text-9xl"></i>
                    </div>
                    
                    <!-- Header -->
                    <div class="mb-4 md:mb-6 relative z-10 shrink-0">
                        <div class="flex items-end gap-2 md:gap-4">
                            <span id="osi-layer-num" class="text-4xl md:text-5xl font-bold text-cyber-neon font-mono leading-none">L1</span>
                            <div>
                                <h3 id="osi-title" class="text-xl md:text-3xl font-bold text-white leading-tight">Physical</h3>
                                <p id="osi-desc" class="text-white mt-1 text-sm md:text-lg text-gray-300">Среда передачи.</p>
                            </div>
                        </div>
                        <div class="mt-2 inline-block bg-black/40 px-2 py-1 rounded border border-white/10">
                             <span class="text-gray-400 font-mono text-xs md:text-sm">Тех: <span id="osi-tech" class="text-cyber-blue font-bold">Wi-Fi</span></span>
                        </div>
                    </div>

                    <!-- Scrollable Content Area -->
                    <div class="overflow-y-auto pr-2 custom-scroll flex-grow">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 relative z-10 pb-4">
                            <!-- Analogy -->
                            <div class="osi-card bg-black/30 p-4 rounded-lg border border-white/5 flex flex-col">
                                <h4 class="text-cyber-neon font-bold mb-2 flex items-center gap-2 border-b border-white/10 pb-2 text-sm md:text-base">
                                    <i class="fa-solid fa-envelope"></i> Аналогия (Почта)
                                </h4>
                                <p id="osi-analogy" class="text-gray-200 text-sm md:text-lg leading-relaxed">
                                    Грузовик.
                                </p>
                            </div>
                            
                            <!-- Threats -->
                            <div class="osi-card bg-black/30 p-4 rounded-lg border border-white/5 flex flex-col">
                                <h4 class="text-cyber-alert font-bold mb-2 flex items-center gap-2 border-b border-white/10 pb-2 text-sm md:text-base">
                                    <i class="fa-solid fa-triangle-exclamation"></i> Уязвимости
                                </h4>
                                
                                <div class="mb-3">
                                    <p class="text-[10px] md:text-xs text-gray-500 uppercase tracking-widest mb-1">Аналог угрозы</p>
                                    <p id="osi-threat-analogy" class="text-white text-sm italic bg-cyber-alert/10 p-2 rounded border-l-2 border-cyber-alert">
                                        Взрыв моста.
                                    </p>
                                </div>

                                <div>
                                    <p class="text-[10px] md:text-xs text-gray-500 uppercase tracking-widest mb-1">Атаки</p>
                                    <ul id="osi-threats" class="list-disc pl-5 space-y-1 text-gray-300 text-xs md:text-sm">
                                        <li>Обрыв кабеля</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 2: Wireless Threats -->
    <section class="slide bg-cyber-black no-scrollbar" id="slide-2">
        <div class="w-full max-w-6xl pt-8 pb-16">
            <h2 class="text-2xl md:text-4xl font-bold mb-6 text-cyber-neon border-l-4 border-cyber-neon pl-4">Беспроводные Угрозы</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-12">
                <!-- 2G/Mobile -->
                <div class="bg-cyber-gray p-5 md:p-8 rounded-xl border border-white/10">
                    <div class="flex items-center gap-4 mb-4 md:mb-6">
                        <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-cyber-alert/20 flex items-center justify-center text-cyber-alert text-xl md:text-2xl shrink-0">
                            <i class="fa-solid fa-tower-cell"></i>
                        </div>
                        <h3 class="text-xl md:text-2xl font-bold">2G / GSM</h3>
                    </div>
                    <ul class="space-y-3 md:space-y-4">
                        <li class="bg-black/40 p-3 md:p-4 rounded border-l-2 border-cyber-alert">
                            <strong class="text-white block mb-1 text-sm md:text-base">Downgrade Attack</strong>
                            <span class="text-xs md:text-sm text-gray-400">Сброс с LTE на 2G, где нет шифрования.</span>
                        </li>
                        <li class="bg-black/40 p-3 md:p-4 rounded border-l-2 border-cyber-alert">
                            <strong class="text-white block mb-1 text-sm md:text-base">IMSI Catcher</strong>
                            <span class="text-xs md:text-sm text-gray-400">Ложная вышка перехватывает трафик.</span>
                        </li>
                    </ul>
                </div>

                <!-- Wi-Fi -->
                <div class="bg-cyber-gray p-5 md:p-8 rounded-xl border border-white/10">
                    <div class="flex items-center gap-4 mb-4 md:mb-6">
                        <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-yellow-500/20 flex items-center justify-center text-yellow-500 text-xl md:text-2xl shrink-0">
                            <i class="fa-solid fa-wifi"></i>
                        </div>
                        <h3 class="text-xl md:text-2xl font-bold">Wi-Fi (MitM)</h3>
                    </div>
                    
                    <div class="space-y-4 md:space-y-6">
                        <div class="relative bg-black/50 p-4 md:p-6 rounded-lg border border-yellow-500/30">
                            <h4 class="font-bold text-base md:text-lg mb-2">Man-in-the-Middle</h4>
                            <p class="text-xs md:text-sm text-gray-400 mb-3">
                                Хакерская точка "Free_Wifi". Трафик идет через злоумышленника.
                            </p>
                            <div class="flex justify-between items-center text-[10px] md:text-xs font-mono text-gray-500 bg-black p-2 rounded">
                                <span>Вы</span>
                                <i class="fa-solid fa-arrow-right text-red-500 animate-pulse"></i>
                                <span class="text-red-500">Хакер</span>
                                <i class="fa-solid fa-arrow-right text-red-500 animate-pulse"></i>
                                <span>Сайт</span>
                            </div>
                        </div>
                        
                        <div class="bg-black/40 p-3 md:p-4 rounded border-l-2 border-yellow-500">
                             <strong class="text-white block mb-1 text-sm">Совет:</strong>
                             <span class="text-xs md:text-sm text-gray-400">В кафе всегда включайте VPN.</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 3: MitM -->
    <section class="slide bg-cyber-dark no-scrollbar" id="slide-5">
  <div class="w-full max-w-6xl pt-8 pb-16">
    <h2 class="text-2xl md:text-4xl font-bold mb-6 text-cyber-alert border-l-4 border-cyber-alert pl-4">
      MitM, HTTP/HTTPS и сертификаты: где ломается “доверие”
    </h2>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
      <!-- LEFT: HTTP vs HTTPS + keys -->
      <div class="lg:col-span-5 space-y-4">
        <!-- HTTP -->
        <div class="bg-cyber-gray p-5 rounded-xl border border-white/10">
          <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
              <i class="fa-solid fa-lock-open text-cyber-alert text-xl"></i>
            </div>
            <div class="min-w-0">
              <div class="flex items-center gap-2 flex-wrap">
                <span class="tag">HTTP</span>
                <span class="text-white font-bold text-base md:text-lg">Открытый текст</span>
              </div>
              <p class="text-sm text-gray-300 mt-1 leading-relaxed">
                Любой, кто “стоит на пути” (Wi-Fi/провайдер/роутер), видит запросы и ответы.
              </p>
              <div class="mt-3 bg-black/40 border border-white/10 rounded-lg p-3">
                <div class="text-[10px] text-gray-500 uppercase tracking-widest">пример</div>
                <div class="font-mono text-xs md:text-sm text-gray-200 break-words">
                  GET /login?user=ivan&amp;pass=...
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- HTTPS / TLS -->
        <div class="bg-cyber-gray p-5 rounded-xl border border-white/10">
          <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-cyber-neon/20 border border-cyber-neon/30 flex items-center justify-center shrink-0">
              <i class="fa-solid fa-shield-halved text-cyber-neon text-xl"></i>
            </div>
            <div class="min-w-0 w-full">
              <div class="flex items-center gap-2 flex-wrap">
                <span class="tag">HTTPS (TLS)</span>
                <span class="text-white font-bold text-base md:text-lg">Шифрование + проверка сервера</span>
              </div>

              <!-- Mini flow -->
              <div class="mt-3 space-y-2">
                <div class="flex items-center gap-3">
                  <span class="tag">1</span>
                  <span class="text-sm text-gray-300">Сервер даёт сертификат (публичный ключ + подпись CA)</span>
                </div>
                <div class="flex items-center gap-3">
                  <span class="tag">2</span>
                  <span class="text-sm text-gray-300">Браузер проверяет цепочку доверия (CA → сертификат)</span>
                </div>
                <div class="flex items-center gap-3">
                  <span class="tag">3</span>
                  <span class="text-sm text-gray-300">Стороны договариваются о сеансовом ключе</span>
                </div>
                <div class="flex items-center gap-3">
                  <span class="tag">4</span>
                  <span class="text-sm text-gray-300">Дальше всё шифруется симметрично (быстро)</span>
                </div>
              </div>

              <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                  <div class="flex items-center gap-2">
                    <i class="fa-solid fa-key text-gray-400"></i>
                    <div class="text-white font-bold text-sm">Публичный ключ</div>
                  </div>
                  <p class="text-xs text-gray-300 mt-1 leading-relaxed">
                    В сертификате. Нужен, чтобы подтвердить “это правда сервер”.
                  </p>
                </div>
                <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                  <div class="flex items-center gap-2">
                    <i class="fa-solid fa-user-secret text-gray-400"></i>
                    <div class="text-white font-bold text-sm">Приватный ключ</div>
                  </div>
                  <p class="text-xs text-gray-300 mt-1 leading-relaxed">
                    Хранится у сервера. Никогда не должен “утечь”.
                  </p>
                </div>
              </div>

              <div class="mt-4 flex items-center gap-3">
                <div class="flex-1"><div class="flowline"></div></div>
                <span class="tag"><i class="fa-solid fa-lock"></i> дальше трафик шифрован</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: MITM with trusted root -->
      <div class="lg:col-span-7 bg-black/50 border border-white/10 rounded-xl p-5 md:p-6 relative overflow-hidden">
        <!-- glow -->
        <div class="absolute inset-0 opacity-15 pointer-events-none">
          <div class="absolute -top-24 -left-24 w-72 h-72 rounded-full bg-cyber-purple blur-3xl"></div>
          <div class="absolute -bottom-24 -right-24 w-72 h-72 rounded-full bg-cyber-alert blur-3xl"></div>
        </div>

        <div class="relative z-10 space-y-4">
          <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-cyber-alert flex items-center justify-center shrink-0 shadow-[0_0_20px_rgba(255,107,107,0.35)]">
              <i class="fa-solid fa-triangle-exclamation text-black text-xl"></i>
            </div>
            <div class="min-w-0">
              <div class="text-white font-bold text-base md:text-lg leading-tight">
                MitM в HTTPS становится возможен, если вы доверили устройству “новый корень”
              </div>
              <p class="text-sm text-gray-300 mt-1 leading-relaxed">
                Например, когда сертификат добавлен в <strong>доверенные корневые</strong> (ОС/браузера) — через установщик/браузер/политику.
              </p>
            </div>
          </div>

          <!-- Conditions -->
          <div class="bg-black/40 border border-white/10 rounded-xl p-4">
            <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-2">нужно 3 условия</div>
            <div class="flex flex-wrap gap-2">
              <span class="tag"><i class="fa-solid fa-certificate"></i> доверенный Root CA</span>
              <span class="tag"><i class="fa-solid fa-route"></i> перехватчик “на пути”</span>
              <span class="tag"><i class="fa-solid fa-thumbtack"></i> нет pinning</span>
            </div>
          </div>

          <!-- Steps: vertical -->
          <div class="space-y-3">
            <!-- Step 1 -->
            <div class="bg-cyber-gray/70 border border-white/10 rounded-xl p-4">
              <div class="flex items-start gap-3">
                <div class="w-10 h-10 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
                  <span class="tag">1</span>
                </div>
                <div class="min-w-0">
                  <div class="text-white font-bold text-sm md:text-base">
                    Корневой сертификат добавлен в доверенные
                  </div>
                  <p class="text-xs md:text-sm text-gray-300 mt-1 leading-relaxed">
                    Теперь устройство верит сертификатам, которые “порождает” этот центр сертификации.
                  </p>
                </div>
              </div>
            </div>

            <div class="flex items-center gap-3">
              <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
              <div class="flex-1"><div class="flowline"></div></div>
            </div>

            <!-- Step 2 -->
            <div class="bg-cyber-gray/70 border border-white/10 rounded-xl p-4">
              <div class="flex items-start gap-3">
                <div class="w-10 h-10 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
                  <span class="tag">2</span>
                </div>
                <div class="min-w-0 w-full">
                  <div class="text-white font-bold text-sm md:text-base">
                    Перехватчик показывает “правильный” сертификат для любого сайта
                  </div>
                  <p class="text-xs md:text-sm text-gray-300 mt-1 leading-relaxed">
                    Браузер видит: подпись валидна (цепочка доверия сходится) — значит “сервер настоящий”.
                  </p>

                  <div class="mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3 items-stretch">
                    <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                      <div class="text-[10px] text-gray-500 uppercase tracking-widest">пользователь</div>
                      <div class="flex items-center gap-2 mt-1">
                        <i class="fa-brands fa-chrome text-gray-300"></i>
                        <span class="text-sm text-white font-bold">Браузер</span>
                      </div>
                    </div>
                    <div class="bg-black/40 border border-cyber-alert/40 rounded-lg p-3">
                      <div class="text-[10px] text-gray-500 uppercase tracking-widest">на пути</div>
                      <div class="flex items-center gap-2 mt-1">
                        <i class="fa-solid fa-spider text-cyber-alert"></i>
                        <span class="text-sm text-white font-bold">MitM-прокси</span>
                      </div>
                    </div>
                    <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                      <div class="text-[10px] text-gray-500 uppercase tracking-widest">сайт</div>
                      <div class="flex items-center gap-2 mt-1">
                        <i class="fa-solid fa-building-columns text-gray-300"></i>
                        <span class="text-sm text-white font-bold">bank.com</span>
                      </div>
                    </div>
                  </div>

                  <div class="mt-3 bg-black/40 border border-white/10 rounded-lg p-3">
                    <div class="flex items-center justify-between gap-2">
                      <span class="tag"><i class="fa-solid fa-stamp"></i> “bank.com” cert</span>
                      <span class="text-[10px] font-mono text-gray-400">подписан Root CA</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="flex items-center gap-3">
              <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
              <div class="flex-1"><div class="flowline"></div></div>
            </div>

            <!-- Step 3 -->
            <div class="bg-cyber-gray/70 border border-white/10 rounded-xl p-4">
              <div class="flex items-start gap-3">
                <div class="w-10 h-10 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
                  <span class="tag">3</span>
                </div>
                <div class="min-w-0 w-full">
                  <div class="text-white font-bold text-sm md:text-base">
                    Трафик расшифровывается внутри прокси и шифруется снова
                  </div>
                  <p class="text-xs md:text-sm text-gray-300 mt-1 leading-relaxed">
                    С точки зрения браузера “всё зелёное”, но фактически вы общаетесь с прокси, а не напрямую с сайтом.
                  </p>

                  <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                      <div class="flex items-center gap-2">
                        <i class="fa-solid fa-lock-open text-cyber-neon"></i>
                        <div class="text-white font-bold text-sm">Внутри прокси</div>
                      </div>
                      <div class="font-mono text-xs md:text-sm text-cyber-neon mt-2 break-words">
                        "платёж: 1000 ₽"
                      </div>
                    </div>
                    <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                      <div class="flex items-center gap-2">
                        <i class="fa-solid fa-lock text-gray-300"></i>
                        <div class="text-white font-bold text-sm">Снаружи (в сеть)</div>
                      </div>
                      <div class="font-mono text-xs md:text-sm text-gray-300 mt-2 break-words">
                        8A1F...C92B...
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Why "гос-во" -->
          <div class="bg-black/40 border border-cyber-alert/30 rounded-xl p-4">
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-landmark text-cyber-alert mt-0.5"></i>
              <div class="min-w-0">
                <div class="text-white font-bold text-sm md:text-base">Почему это может дать доступ “на уровне государства”</div>
                <p class="text-xs md:text-sm text-gray-300 mt-1 leading-relaxed">
                  Если корневой CA контролируется/управляется госструктурой и перехватчик стоит на магистрали (например, у оператора),
                  то технически можно выпускать “доверенные” сертификаты и читать HTTPS-трафик на участке перехвата.
                </p>
              </div>
            </div>
          </div>

          <!-- Protections -->
          <div class="bg-cyber-gray/40 border border-white/10 rounded-xl p-4">
            <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-2">что усложняет MitM</div>
            <div class="flex flex-wrap gap-2">
              <span class="tag">HSTS</span>
              <span class="tag">Certificate Pinning</span>
              <span class="tag">отдельный профиль/устройство</span>
              <span class="tag">не ставить Root CA “в систему”</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- DNS -->
<section class="slide bg-cyber-dark no-scrollbar" id="slide-6"> <div class="w-full max-w-6xl pt-8 pb-16"> <h2 class="text-2xl md:text-4xl font-bold mb-6 text-cyber-neon border-l-4 border-cyber-neon pl-4"> DNS: как работает и что видит провайдер </h2>
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
    <!-- LEFT: коротко и понятно -->
    <div class="lg:col-span-4 space-y-4">
        <div class="bg-cyber-gray p-5 rounded-xl border border-white/10">
        <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-cyber-neon/15 border border-cyber-neon/30 flex items-center justify-center shrink-0">
            <i class="fa-solid fa-book-atlas text-cyber-neon text-xl"></i>
            </div>
            <div class="min-w-0">
            <div class="text-white font-bold text-lg leading-tight">DNS = “телефонная книга” интернета</div>
            <p class="text-sm text-gray-300 mt-2 leading-relaxed">
                Переводит <strong>имя сайта</strong> (example.com) в <strong>IP-адрес</strong> (куда подключаться).
            </p>
            </div>
        </div>
        </div>

        <div class="bg-black/30 p-5 rounded-xl border border-white/10">
        <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
            <i class="fa-solid fa-tower-broadcast text-gray-200 text-xl"></i>
            </div>
            <div class="min-w-0">
            <div class="text-white font-bold text-base">DNS провайдера (ISP DNS)</div>
            <p class="text-sm text-gray-300 mt-2 leading-relaxed">
                Обычно ваш компьютер спрашивает <strong>DNS-резолвер провайдера</strong>. Он может отвечать из кэша или “дозваниваться” дальше.
            </p>
            </div>
        </div>
        </div>

        <div class="bg-cyber-gray p-5 rounded-xl border border-white/10">
        <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-cyber-alert/20 border border-cyber-alert/30 flex items-center justify-center shrink-0">
            <i class="fa-solid fa-eye text-cyber-alert text-xl"></i>
            </div>
            <div class="min-w-0">
            <div class="text-white font-bold text-base">Главная мысль</div>
            <p class="text-sm text-gray-300 mt-2 leading-relaxed">
                Если DNS не шифрован, провайдер <strong>видит домены</strong>, которые вы запрашиваете (и когда).
            </p>
            </div>
        </div>
        </div>
    </div>

    <!-- RIGHT: инфографика (mobile-first вертикально) -->
    <div class="lg:col-span-8 bg-black/50 border border-white/10 rounded-xl p-5 md:p-6 relative overflow-hidden">
        <!-- glow -->
        <div class="absolute inset-0 opacity-15 pointer-events-none">
        <div class="absolute -top-24 -left-24 w-72 h-72 rounded-full bg-cyber-purple blur-3xl"></div>
        <div class="absolute -bottom-24 -right-24 w-72 h-72 rounded-full bg-cyber-blue blur-3xl"></div>
        </div>

        <div class="relative z-10 space-y-4">
        <!-- STEP 1 -->
        <div class="bg-black/35 border border-white/10 rounded-xl p-4">
            <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
                <span class="tag">1</span>
            </div>
            <div class="min-w-0 w-full">
                <div class="flex items-center gap-2 flex-wrap">
                <i class="fa-solid fa-laptop text-gray-300"></i>
                <div class="text-white font-bold">Ваше устройство</div>
                <span class="tag">“Где google.com?”</span>
                </div>
                <div class="mt-2 bg-black/40 border border-white/10 rounded-lg p-3">
                <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">DNS запрос</div>
                <div class="font-mono text-xs md:text-sm text-gray-200 break-words">
                    По какому IP адресу находится google.com ?
                </div>
                </div>
            </div>
            </div>
        </div>

        <div class="flex items-center gap-3">
            <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
            <div class="flex-1"><div class="flowline"></div></div>
        </div>

        <!-- STEP 2 -->
        <div class="bg-cyber-gray/60 border border-white/10 rounded-xl p-4">
            <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-cyber-neon/15 border border-cyber-neon/30 flex items-center justify-center shrink-0">
                <i class="fa-solid fa-building-wheat text-cyber-neon text-xl"></i>
            </div>
            <div class="min-w-0 w-full">
                <div class="flex items-center gap-2 flex-wrap">
                <span class="tag">2</span>
                <div class="text-white font-bold">DNS-резолвер провайдера</div>
                <span class="tag">кэш / рекурсия</span>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 mt-3">
                <div class="bg-black/35 border border-white/10 rounded-lg p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest">root</div>
                    <div class="text-sm text-gray-200 font-bold">.</div>
                </div>
                <div class="bg-black/35 border border-white/10 rounded-lg p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest">tld</div>
                    <div class="text-sm text-gray-200 font-bold">.com</div>
                </div>
                <div class="bg-black/35 border border-white/10 rounded-lg p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest">authoritative</div>
                    <div class="text-sm text-gray-200 font-bold">google.com</div>
                </div>
                </div>
            </div>
            </div>
        </div>

        <div class="flex items-center gap-3">
            <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
            <div class="flex-1"><div class="flowline"></div></div>
        </div>

        <!-- STEP 3 -->
        <div class="bg-black/35 border border-white/10 rounded-xl p-4">
            <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
                <span class="tag">3</span>
            </div>
            <div class="min-w-0 w-full">
                <div class="flex items-center gap-2 flex-wrap">
                <i class="fa-solid fa-reply text-gray-300"></i>
                <div class="text-white font-bold">Ответ DNS</div>
                <span class="tag">IP адрес</span>
                </div>
                <div class="mt-2 bg-black/40 border border-white/10 rounded-lg p-3">
                <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">DNS ответ</div>
                <div class="font-mono text-xs md:text-sm text-gray-200 break-words">
                    google.com → 142.250.x.x
                </div>
                </div>
            </div>
            </div>
        </div>

        <div class="flex items-center gap-3">
            <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
            <div class="flex-1"><div class="flowline"></div></div>
        </div>

        <!-- STEP 4 -->
        <div class="bg-cyber-blue/10 border border-cyber-blue/30 rounded-xl p-4">
            <div class="flex items-start gap-3">
            <div class="w-11 h-11 rounded-lg bg-cyber-blue/20 border border-cyber-blue/30 flex items-center justify-center shrink-0">
                <i class="fa-solid fa-lock text-cyber-blue text-xl"></i>
            </div>
            <div class="min-w-0 w-full">
                <div class="flex items-center gap-2 flex-wrap">
                <span class="tag">4</span>
                <div class="text-white font-bold">Подключение к сайту (HTTPS)</div>
                <span class="tag">контент шифрован</span>
                </div>
                <div class="mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">провайдер видит</div>
                    <div class="text-sm text-gray-200">IP сервера + факт соединения</div>
                </div>
                <div class="bg-black/40 border border-white/10 rounded-lg p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">провайдер НЕ видит</div>
                    <div class="text-sm text-gray-200">страницы/пароли/поисковую фразу</div>
                </div>
                </div>
            </div>
            </div>
        </div>

        <!-- WHAT ISP SEES -->
        <div class="bg-black/40 border border-white/10 rounded-xl p-4">
            <div class="text-white font-bold mb-3 flex items-center gap-2">
            <i class="fa-solid fa-eye text-cyber-alert"></i>
            Что провайдер видит на практике
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
            <div class="bg-black/35 border border-white/10 rounded-lg p-3">
                <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">DNS (если обычный)</div>
                <div class="text-sm text-gray-200">Домены, которые вы запрашиваете</div>
                <div class="text-xs text-gray-400 mt-1">пример: google.com, youtube.com, bank.com</div>
            </div>
            <div class="bg-black/35 border border-white/10 rounded-lg p-3">
                <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">HTTPS</div>
                <div class="text-sm text-gray-200">IP + время + объём трафика</div>
                <div class="text-xs text-gray-400 mt-1">но не содержимое страниц</div>
            </div>
            <div class="bg-black/35 border border-white/10 rounded-lg p-3">
                <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">когда вы “гуглите”</div>
                <div class="text-sm text-gray-200">Факт: вы на google.com</div>
                <div class="text-xs text-gray-400 mt-1">сама фраза обычно скрыта HTTPS</div>
            </div>
            <div class="bg-black/35 border border-white/10 rounded-lg p-3">
                <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">что может делать ISP DNS</div>
                <div class="text-sm text-gray-200">Блок/подмена ответа/редирект</div>
                <div class="text-xs text-gray-400 mt-1">через DNS-ответ</div>
            </div>
            </div>
        </div>

        <!-- MINI: privacy tip -->
        <div class="bg-cyber-gray/40 border border-white/10 rounded-xl p-4">
            <div class="text-white font-bold mb-2 flex items-center gap-2">
            <i class="fa-solid fa-shield-halved text-cyber-neon"></i>
            Как снизить “видимость” доменов
            </div>
            <div class="flex flex-wrap gap-2">
            <span class="tag">DoT / DoH</span>
            <span class="tag">другой DNS-резолвер</span>
            <span class="tag">VPN</span>
            </div>
        </div>

        <!-- Sources as a comment (keeps section-only format) -->
        <!-- Sources: Cloudflare DNS overview & ISP recursive resolver role: :contentReference[oaicite:0]{index=0} ; DNS-over-TLS privacy (IETF RFC 7858): :contentReference[oaicite:1]{index=1} -->
        </div>
    </div>
    </div>
</section>

<section class="slide bg-cyber-dark no-scrollbar" id="slide-6">
  <div class="w-full max-w-6xl pt-8 pb-16">
    <h2 class="text-2xl md:text-4xl font-bold mb-6 text-cyber-neon border-l-4 border-cyber-neon pl-4">
      DNS: “имя сайта” → “IP адрес”
    </h2>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
      <!-- LEFT: супер-наглядная схема -->
      <div class="lg:col-span-7 bg-black/50 border border-white/10 rounded-xl p-5 md:p-6 relative overflow-hidden">
        <!-- glow -->
        <div class="absolute inset-0 opacity-15 pointer-events-none">
          <div class="absolute -top-24 -left-24 w-72 h-72 rounded-full bg-cyber-purple blur-3xl"></div>
          <div class="absolute -bottom-24 -right-24 w-72 h-72 rounded-full bg-cyber-blue blur-3xl"></div>
        </div>

        <div class="relative z-10 space-y-4 max-w-2xl mx-auto lg:max-w-none">
          <!-- STEP 1 -->
          <div class="bg-black/35 border border-white/10 rounded-xl p-4">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
                <i class="fa-solid fa-laptop text-2xl text-gray-200"></i>
              </div>
              <div class="min-w-0">
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="text-[10px] font-mono px-2 py-0.5 rounded-full bg-black/40 border border-white/10 text-gray-300">1</span>
                  <span class="text-white font-bold text-base">Вы вводите сайт</span>
                </div>
                <div class="mt-2 font-mono text-sm text-gray-200 break-words">google.com</div>
              </div>
            </div>
          </div>

          <!-- ARROW -->
          <div class="flex items-center gap-3 px-1">
            <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
            <div class="flex-1 h-1 bg-white/10 rounded-full overflow-hidden relative">
              <div class="absolute inset-0 bg-cyber-neon/30 animate-pulse"></div>
            </div>
          </div>

          <!-- STEP 2 -->
          <div class="bg-cyber-gray/60 border border-white/10 rounded-xl p-4">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-xl bg-cyber-neon/15 border border-cyber-neon/30 flex items-center justify-center shrink-0">
                <i class="fa-solid fa-tower-broadcast text-2xl text-cyber-neon"></i>
              </div>
              <div class="min-w-0 w-full">
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="text-[10px] font-mono px-2 py-0.5 rounded-full bg-black/40 border border-white/10 text-gray-300">2</span>
                  <span class="text-white font-bold text-base">DNS провайдера</span>
                  <span class="text-[10px] font-mono px-2 py-0.5 rounded-full bg-black/40 border border-white/10 text-gray-300">“какой IP?”</span>
                </div>

                <div class="mt-3 rounded-lg border border-white/10 bg-black/35 p-3">
                  <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">DNS запрос</div>
                  <div class="font-mono text-xs md:text-sm text-gray-200 break-words">По какому IP адресу находится google.com ?</div>
                </div>
              </div>
            </div>
          </div>

          <!-- ARROW -->
          <div class="flex items-center gap-3 px-1">
            <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
            <div class="flex-1 h-1 bg-white/10 rounded-full overflow-hidden relative">
              <div class="absolute inset-0 bg-cyber-neon/30 animate-pulse"></div>
            </div>
          </div>

          <!-- STEP 3: DNS hierarchy (mostly icons) -->
          <div class="bg-black/35 border border-white/10 rounded-xl p-4">
            <div class="flex items-start gap-3">
              <div class="w-12 h-12 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center shrink-0">
                <i class="fa-solid fa-sitemap text-2xl text-gray-200"></i>
              </div>
              <div class="min-w-0 w-full">
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="text-[10px] font-mono px-2 py-0.5 rounded-full bg-black/40 border border-white/10 text-gray-300">3</span>
                  <span class="text-white font-bold text-base">“Спрашивает дальше”</span>
                </div>

                <div class="mt-3 grid grid-cols-3 gap-2">
                  <div class="rounded-lg border border-white/10 bg-black/35 p-3 text-center">
                    <div class="text-2xl text-gray-200"><i class="fa-solid fa-globe"></i></div>
                    <div class="text-[10px] font-mono text-gray-400 mt-1">ROOT</div>
                  </div>
                  <div class="rounded-lg border border-white/10 bg-black/35 p-3 text-center">
                    <div class="text-2xl text-gray-200"><i class="fa-solid fa-circle-nodes"></i></div>
                    <div class="text-[10px] font-mono text-gray-400 mt-1">.COM</div>
                  </div>
                  <div class="rounded-lg border border-white/10 bg-black/35 p-3 text-center">
                    <div class="text-2xl text-gray-200"><i class="fa-solid fa-building-columns"></i></div>
                    <div class="text-[10px] font-mono text-gray-400 mt-1">google.com</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ARROW -->
          <div class="flex items-center gap-3 px-1">
            <div class="w-10 shrink-0 flex justify-center text-gray-500"><i class="fa-solid fa-arrow-down"></i></div>
            <div class="flex-1 h-1 bg-white/10 rounded-full overflow-hidden relative">
              <div class="absolute inset-0 bg-cyber-neon/30 animate-pulse"></div>
            </div>
          </div>

          <!-- STEP 4: Answer + HTTPS -->
          <div class="bg-cyber-blue/10 border border-cyber-blue/30 rounded-xl p-4">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-xl bg-cyber-blue/20 border border-cyber-blue/30 flex items-center justify-center shrink-0">
                <i class="fa-solid fa-lock text-2xl text-cyber-blue"></i>
              </div>
              <div class="min-w-0 w-full">
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="text-[10px] font-mono px-2 py-0.5 rounded-full bg-black/40 border border-white/10 text-gray-300">4</span>
                  <span class="text-white font-bold text-base">Ответ: IP → HTTPS</span>
                </div>

                <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2">
                  <div class="rounded-lg border border-white/10 bg-black/35 p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">DNS ответ</div>
                    <div class="font-mono text-xs md:text-sm text-gray-200 break-words">google.com → 142.250.x.x</div>
                  </div>
                  <div class="rounded-lg border border-white/10 bg-black/35 p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest mb-1">Дальше</div>
                    <div class="text-sm text-gray-200 flex items-center gap-2">
                      <i class="fa-solid fa-shield-halved text-cyber-blue"></i>
                      <span>контент шифрован</span>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <!-- Tiny: privacy shortcut (icon-only-ish) -->
          <div class="flex flex-wrap gap-2 pt-1">
            <span class="text-[10px] font-mono px-2 py-1 rounded-full bg-black/40 border border-white/10 text-gray-300">
              <i class="fa-solid fa-lock mr-1"></i> DoH/DoT шифруют DNS
            </span>
            <span class="text-[10px] font-mono px-2 py-1 rounded-full bg-black/40 border border-white/10 text-gray-300">
              <i class="fa-solid fa-network-wired mr-1"></i> VPN прячет домены от ISP DNS
            </span>
          </div>
        </div>
      </div>

      <!-- RIGHT: what ISP sees (almost no text) -->
      <div class="lg:col-span-5 space-y-4">
        <div class="bg-black/50 border border-white/10 rounded-xl p-5 md:p-6">
          <div class="flex items-center gap-2 mb-4">
            <i class="fa-solid fa-eye text-cyber-alert text-xl"></i>
            <div class="text-white font-bold text-lg">Что видит провайдер</div>
          </div>

          <div class="grid grid-cols-2 gap-3">
            <!-- sees -->
            <div class="rounded-xl border border-cyber-neon/30 bg-cyber-neon/10 p-4">
              <div class="text-white font-bold text-sm mb-3 flex items-center gap-2">
                <i class="fa-solid fa-check text-cyber-neon"></i> Видит
              </div>
              <div class="space-y-3">
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-globe text-cyber-neon"></i>
                  <span class="text-sm text-gray-200">домены (DNS)</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-location-dot text-cyber-neon"></i>
                  <span class="text-sm text-gray-200">IP сервера</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-clock text-cyber-neon"></i>
                  <span class="text-sm text-gray-200">время</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-database text-cyber-neon"></i>
                  <span class="text-sm text-gray-200">объём</span>
                </div>
              </div>
            </div>

            <!-- does not see -->
            <div class="rounded-xl border border-white/10 bg-black/35 p-4">
              <div class="text-white font-bold text-sm mb-3 flex items-center gap-2">
                <i class="fa-solid fa-xmark text-gray-400"></i> Не видит (HTTPS)
              </div>
              <div class="space-y-3">
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-file-lines text-gray-400"></i>
                  <span class="text-sm text-gray-200">страницы</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-magnifying-glass text-gray-400"></i>
                  <span class="text-sm text-gray-200">текст поиска</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-key text-gray-400"></i>
                  <span class="text-sm text-gray-200">пароли</span>
                </div>
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-image text-gray-400"></i>
                  <span class="text-sm text-gray-200">контент</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Extra visual hint: DNS tampering -->
        <div class="bg-black/50 border border-white/10 rounded-xl p-5 md:p-6">
          <div class="flex items-center gap-2 mb-3">
            <i class="fa-solid fa-wand-magic-sparkles text-cyber-alert"></i>
            <div class="text-white font-bold text-lg">DNS можно “подменить”</div>
          </div>
          <div class="grid grid-cols-3 gap-2">
            <div class="rounded-lg border border-white/10 bg-black/35 p-3 text-center">
              <i class="fa-solid fa-ban text-cyber-alert text-2xl"></i>
              <div class="text-[10px] font-mono text-gray-400 mt-1">block</div>
            </div>
            <div class="rounded-lg border border-white/10 bg-black/35 p-3 text-center">
              <i class="fa-solid fa-shuffle text-cyber-alert text-2xl"></i>
              <div class="text-[10px] font-mono text-gray-400 mt-1">redirect</div>
            </div>
            <div class="rounded-lg border border-white/10 bg-black/35 p-3 text-center">
              <i class="fa-solid fa-triangle-exclamation text-cyber-alert text-2xl"></i>
              <div class="text-[10px] font-mono text-gray-400 mt-1">spoof</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>




    <!-- SLIDE 4: SORM & Censorship -->
    <section class="slide bg-cyber-dark no-scrollbar" id="slide-3">
        <div class="w-full max-w-6xl pt-8 pb-16">
            <h2 class="text-2xl md:text-4xl font-bold mb-6 text-cyber-neon border-l-4 border-cyber-neon pl-4">Госслежка (СОРМ)</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-12 gap-6 md:gap-8">
                <!-- Text Content -->
                <div class="md:col-span-7 space-y-4 md:space-y-6">
                    <div class="bg-cyber-gray p-5 md:p-6 rounded-xl border border-white/10">
                        <h3 class="text-lg md:text-xl font-bold text-white mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-server text-blue-400"></i> СОРМ
                        </h3>
                        <p class="text-gray-400 text-xs md:text-sm mb-4">
                            "Черный ящик" у провайдера, копирующий трафик для ФСБ.
                        </p>
                        <div class="grid grid-cols-2 gap-2 text-xs md:text-sm">
                            <div class="bg-black/30 p-2 rounded"><span class="text-blue-400 font-bold">СОРМ-1:</span> Звонки</div>
                            <div class="bg-black/30 p-2 rounded"><span class="text-blue-400 font-bold">СОРМ-2:</span> Интернет</div>
                            <div class="bg-black/30 p-2 rounded"><span class="text-blue-400 font-bold">СОРМ-3:</span> Хранение, агрегация, анализ (BigData)</div>
                        </div>
                    </div>

                    <div class="bg-cyber-gray p-5 md:p-6 rounded-xl border border-white/10">
                        <h3 class="text-lg md:text-xl font-bold text-white mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-microchip text-red-500"></i> ТСПУ (РКН)
                        </h3>
                        <p class="text-gray-400 text-xs md:text-sm mb-3">
                            Оборудование для блокировок и замедления (DPI).
                        </p>
                        <ul class="space-y-1 text-xs md:text-sm text-gray-300">
                            <li><i class="fa-solid fa-ban text-red-500 w-4"></i> Замедление YouTube</li>
                            <li><i class="fa-solid fa-phone-slash text-red-500 w-4"></i> Блок звонков WhatsApp</li>
                        </ul>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="md:col-span-5 flex flex-col items-center justify-center bg-cyber-gray p-4 md:p-6 rounded-xl border border-white/10">
                    <h4 class="mb-4 font-bold text-gray-300 text-sm md:text-base">Замедление (Throttling)</h4>
                    <div class="chart-container">
                        <canvas id="censorshipChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

<!-- SLIDE 5: Malware + TLS MITM + MTProto (mobile-first infographic) -->
<section class="slide bg-cyber-dark no-scrollbar" id="slide-4">
<div class="w-full max-w-6xl pt-8 pb-16">
    <h2 class="text-2xl md:text-4xl font-bold mb-6 text-cyber-alert border-l-4 border-cyber-alert pl-4">
      Malware: HTTPS → MTProto → текст сообщения
    </h2>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
      <!-- LEFT: minimal steps -->
      <div class="lg:col-span-4 space-y-3">
        <div class="bg-cyber-gray p-5 rounded-xl border border-white/10">
          <h3 class="font-bold text-white text-lg mb-3">Сценарий (в 4 шага)</h3>
          <div class="space-y-2 text-sm text-gray-300">
            <div class="flex items-center gap-2">
              <span class="tag">1</span>
              <span>Подмена доверия к SSL → TLS-перехват</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="tag">2</span>
              <span>HTTPS раскрыт, но внутри ещё MTProto-шифротекст</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="tag">3</span>
              <span>Добыча MTProto ключа/сессии на устройстве</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="tag">4</span>
              <span>Расшифровка MTProto payload → читаемый текст</span>
            </div>
          </div>
        </div>

        <div class="bg-black/30 p-5 rounded-xl border border-white/10">
          <div class="flex items-start gap-3">
            <i class="fa-solid fa-triangle-exclamation text-cyber-alert mt-0.5"></i>
            <p class="text-sm text-gray-300 leading-relaxed">
              Важно: это про <strong>контроль устройства</strong>. Тогда “вскрытие” становится вопросом доверия/ключей на клиенте,
              а не “магии взлома шифрования в интернете”.
            </p>
          </div>
        </div>
      </div>

      <!-- RIGHT: infographic (mobile-first vertical flow) -->
      <div class="lg:col-span-8 bg-black/50 border border-white/10 rounded-xl p-5 md:p-6 relative overflow-hidden">
        <!-- glow -->
        <div class="absolute inset-0 opacity-15 pointer-events-none">
          <div class="absolute -top-24 -left-24 w-72 h-72 rounded-full bg-cyber-purple blur-3xl"></div>
          <div class="absolute -bottom-24 -right-24 w-72 h-72 rounded-full bg-cyber-blue blur-3xl"></div>
        </div>

        <div class="relative z-10 max-w-2xl mx-auto lg:max-w-none space-y-3">
          <!-- Malware boundary -->
          <div class="border-2 border-dashed border-cyber-alert/45 rounded-xl bg-cyber-alert/5 p-3 md:p-4">
            <div class="flex items-center justify-between gap-3 mb-3">
              <div class="flex items-center gap-2 min-w-0">
                <div class="w-10 h-10 rounded-full bg-blue-500/25 border border-blue-400/30 flex items-center justify-center shrink-0">
                  <i class="fa-brands fa-telegram text-xl text-blue-300"></i>
                </div>
                <div class="min-w-0">
                  <div class="text-white font-bold text-sm md:text-base break-words">Telegram client</div>
                  <div class="text-[11px] text-gray-400 font-mono break-words">устройство заражено</div>
                </div>
              </div>

              <div class="text-[10px] font-mono text-cyber-alert animate-pulse shrink-0">MALWARE ACTIVE</div>

              <div class="flex items-center gap-2 min-w-0">
                <div class="min-w-0 text-right">
                  <div class="text-white font-bold text-sm md:text-base break-words">Telegram servers</div>
                  <div class="text-[11px] text-gray-400 font-mono break-words">интернет</div>
                </div>
                <div class="w-10 h-10 rounded-full bg-gray-700/50 border border-white/10 flex items-center justify-center shrink-0">
                  <i class="fa-solid fa-server text-lg text-gray-300"></i>
                </div>
              </div>
            </div>

            <!-- Step 1 -->
            <div class="bg-black/35 border border-cyber-alert/30 rounded-xl p-3 md:p-4">
              <div class="flex items-start gap-3">
                <div class="w-11 h-11 rounded-lg bg-cyber-alert flex items-center justify-center shrink-0 shadow-[0_0_20px_rgba(255,107,107,0.35)]">
                  <i class="fa-solid fa-certificate text-black text-xl"></i>
                </div>
                <div class="min-w-0">
                  <div class="flex items-center gap-2 flex-wrap">
                    <span class="tag">STEP 1</span>
                    <span class="text-white font-bold text-sm md:text-base break-words">TLS-перехват (подмена доверия)</span>
                  </div>
                  <div class="text-xs text-gray-300 mt-1 break-words">
                    HTTPS трафик становится видимым вредоносу.
                  </div>
                </div>
              </div>
            </div>

            <!-- Arrow -->
            <div class="flex items-center gap-3 py-2">
              <div class="w-10 shrink-0 flex justify-center text-gray-500">
                <i class="fa-solid fa-arrow-down"></i>
              </div>
              <div class="flex-1">
                <div class="flowline"></div>
              </div>
            </div>

            <!-- Step 2: Matryoshka (HTTPS -> MTProto ciphertext) -->
            <div class="bg-black/35 border border-white/10 rounded-xl p-3 md:p-4">
              <div class="flex items-start gap-3">
                <div class="w-11 h-11 rounded-lg bg-cyber-blue/20 border border-cyber-blue/30 flex items-center justify-center shrink-0">
                  <i class="fa-solid fa-layer-group text-cyber-blue text-xl"></i>
                </div>
                <div class="min-w-0 w-full">
                  <div class="flex items-center gap-2 flex-wrap">
                    <span class="tag">STEP 2</span>
                    <span class="text-white font-bold text-sm md:text-base break-words">Внутри HTTPS ещё MTProto</span>
                  </div>

                  <div class="mt-2 space-y-2">
                    <!-- Outer (HTTPS decrypted) -->
                    <div class="rounded-lg border border-white/10 bg-black/30 p-3">
                      <div class="flex items-center justify-between gap-2">
                        <span class="tag"><i class="fa-solid fa-lock-open"></i> HTTPS decrypted</span>
                        <span class="text-[10px] font-mono text-gray-400">видно “контейнер”</span>
                      </div>

                      <!-- Inner (MTProto ciphertext) -->
                      <div class="mt-2 rounded-lg border border-white/10 bg-black/40 p-3">
                        <div class="flex items-center justify-between gap-2">
                          <span class="tag"><i class="fa-solid fa-lock"></i> MTProto ciphertext</span>
                          <span class="text-[10px] font-mono text-gray-400">A9F1…7C2B…</span>
                        </div>
                        <div class="text-xs text-gray-300 mt-2 break-words">
                          Сообщение всё ещё не читается: нужен MTProto ключ/сессия.
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <!-- Arrow -->
            <div class="flex items-center gap-3 py-2">
              <div class="w-10 shrink-0 flex justify-center text-gray-500">
                <i class="fa-solid fa-arrow-down"></i>
              </div>
              <div class="flex-1">
                <div class="flowline"></div>
              </div>
            </div>

            <!-- Step 3 -->
            <div class="bg-black/35 border border-cyber-alert/30 rounded-xl p-3 md:p-4">
              <div class="flex items-start gap-3">
                <div class="w-11 h-11 rounded-lg bg-cyber-alert flex items-center justify-center shrink-0 shadow-[0_0_20px_rgba(255,107,107,0.35)]">
                  <i class="fa-solid fa-key text-black text-xl"></i>
                </div>
                <div class="min-w-0">
                  <div class="flex items-center gap-2 flex-wrap">
                    <span class="tag">STEP 3</span>
                    <span class="text-white font-bold text-sm md:text-base break-words">Добыча MTProto AuthKey/сессии</span>
                  </div>
                  <div class="text-xs text-gray-300 mt-1 break-words">
                    Ключ/сессия берутся на клиенте (там же, где ими пользуется приложение).
                  </div>
                </div>
              </div>
            </div>

            <!-- Arrow -->
            <div class="flex items-center gap-3 py-2">
              <div class="w-10 shrink-0 flex justify-center text-gray-500">
                <i class="fa-solid fa-arrow-down"></i>
              </div>
              <div class="flex-1">
                <div class="flowline"></div>
              </div>
            </div>

            <!-- Step 4 -->
            <div class="bg-black/35 border border-white/10 rounded-xl p-3 md:p-4">
              <div class="flex items-start gap-3">
                <div class="w-11 h-11 rounded-lg bg-cyber-neon flex items-center justify-center shrink-0 shadow-[0_0_20px_rgba(34,211,238,0.28)]">
                  <i class="fa-solid fa-unlock-keyhole text-black text-xl"></i>
                </div>
                <div class="min-w-0 w-full">
                  <div class="flex items-center gap-2 flex-wrap">
                    <span class="tag">STEP 4</span>
                    <span class="text-white font-bold text-sm md:text-base break-words">MTProto decrypt → payload</span>
                  </div>

                  <div class="mt-2 rounded-lg border border-white/10 bg-black/40 p-3">
                    <div class="text-[10px] text-gray-500 uppercase tracking-widest">PLAINTEXT</div>
                    <div class="font-mono text-sm md:text-base text-cyber-neon break-words">"Привет!"</div>
                  </div>
                </div>
              </div>
            </div>

          </div><!-- /malware boundary -->
        </div>
      </div>
    </div>
  </div>
</section>




    <!-- SLIDE 6: Digital Hygiene & Conclusion -->
    <section class="slide bg-cyber-dark no-scrollbar" id="slide-5">
        <div class="w-full max-w-5xl pt-8 pb-16">
            <h2 class="text-2xl md:text-4xl font-bold mb-6 text-cyber-neon border-l-4 border-cyber-neon pl-4">Цифровая Гигиена</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                <div class="space-y-3 md:space-y-4">
                    <div class="bg-cyber-gray p-4 md:p-5 rounded-lg flex items-start gap-3 md:gap-4">
                        <i class="fa-solid fa-lock text-cyber-neon text-lg md:text-xl mt-1"></i>
                        <div>
                            <h4 class="font-bold text-white text-sm md:text-base">DNS over HTTPS</h4>
                            <p class="text-xs md:text-sm text-gray-400">Скрывает список сайтов от провайдера.</p>
                        </div>
                    </div>
                    
                    <div class="bg-cyber-gray p-4 md:p-5 rounded-lg flex items-start gap-3 md:gap-4">
                        <i class="fa-solid fa-shield-halved text-cyber-neon text-lg md:text-xl mt-1"></i>
                        <div>
                            <h4 class="font-bold text-white text-sm md:text-base">VPN</h4>
                            <p class="text-xs md:text-sm text-gray-400">Шифрует весь канал связи.</p>
                        </div>
                    </div>

                    <div class="bg-cyber-gray p-4 md:p-5 rounded-lg flex items-start gap-3 md:gap-4">
                        <i class="fa-brands fa-signal-messenger text-cyber-neon text-lg md:text-xl mt-1"></i>
                        <div>
                            <h4 class="font-bold text-white text-sm md:text-base">Secret Chats</h4>
                            <p class="text-xs md:text-sm text-gray-400">Только E2E шифрование защищает переписку.</p>
                        </div>
                    </div>
                </div>

                <div class="bg-black/30 p-6 md:p-8 rounded-xl border border-cyber-neon/30 flex flex-col justify-center items-center text-center mt-4 md:mt-0">
                    <i class="fa-regular fa-circle-question text-4xl md:text-6xl text-cyber-dim mb-4 md:mb-6"></i>
                    <h3 class="text-2xl md:text-3xl font-bold text-white mb-2 md:mb-4">Вопросы?</h3>
                    <p class="text-gray-400 mb-6 md:mb-8 text-sm md:text-base">
                        Безопасность — это процесс.
                    </p>
                    <button type="button" data-go-home class="px-5 py-2 md:px-6 md:py-2 bg-cyber-neon text-cyber-black font-bold rounded hover:bg-white transition-colors text-sm md:text-base">
                        В начало
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- JavaScript Logic -->
    <script>
                (() => {
            'use strict';

            // Prevent browser from restoring scroll position (reload / BFCache)
            if ('scrollRestoration' in history) {
                history.scrollRestoration = 'manual';
            }

            // --- State Management ---
            let currentSlide = 0;
            const slides = Array.from(document.querySelectorAll('section.slide'));
            const totalSlides = slides.length;

            const progressBar = document.getElementById('progress-bar');
            const currentNumIndicator = document.getElementById('current-slide-num');
            const totalNumIndicator = document.getElementById('total-slide-num');

            function updateTotalIndicator() {
                if (!totalNumIndicator) return;
                totalNumIndicator.innerText = String(totalSlides).padStart(2, '0');
            }

            function scrollPageToTop() {
                // Some mobile browsers still keep a document scroll offset even with overflow:hidden
                window.scrollTo(0, 0);
                document.documentElement.scrollTop = 0;
                document.body.scrollTop = 0;
            }

            function resetScrollInside(el) {
                if (!el) return;
                el.scrollTop = 0;
                el.scrollLeft = 0;
                el.querySelectorAll('.overflow-y-auto, .osi-nav-container').forEach((node) => {
                    node.scrollTop = 0;
                    node.scrollLeft = 0;
                });
            }

            // --- Navigation Logic ---
            function updateSlides({ resetActiveScroll = false } = {}) {
                slides.forEach((slide, index) => {
                    slide.classList.remove('active', 'prev', 'next');
                    if (index === currentSlide) {
                        slide.classList.add('active');
                    } else if (index < currentSlide) {
                        slide.classList.add('prev');
                    } else {
                        slide.classList.add('next');
                    }
                });

                // Update UI
                const denom = Math.max(1, totalSlides - 1);
                const progress = (currentSlide / denom) * 100;
                if (progressBar) progressBar.style.width = `${progress}%`;

                if (currentNumIndicator) {
                    currentNumIndicator.innerText = String(currentSlide + 1).padStart(2, '0');
                }

                if (resetActiveScroll) {
                    resetScrollInside(slides[currentSlide]);
                }
            }

            function goToSlide(index, { resetActiveScroll = true } = {}) {
                const nextIndex = Math.min(Math.max(index, 0), totalSlides - 1);
                currentSlide = nextIndex;
                updateSlides({ resetActiveScroll });

                // Force browser to actually be at the top (fixes "black screen" after refresh on some mobiles)
                requestAnimationFrame(() => scrollPageToTop());
            }

            function changeSlide(direction) {
                goToSlide(currentSlide + direction, { resetActiveScroll: true });
            }

            // Buttons (no inline onclick)
            document.querySelectorAll('[data-slide-dir]').forEach((btn) => {
                btn.addEventListener('click', () => {
                    const dir = parseInt(btn.dataset.slideDir || '0', 10);
                    changeSlide(dir);
                });
            });

            const homeBtn = document.querySelector('[data-go-home]');
            if (homeBtn) {
                homeBtn.addEventListener('click', () => goToSlide(0, { resetActiveScroll: true }));
            }

            // Keyboard Controls
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowDown' || e.key === 'ArrowRight' || e.code === 'Space') {
                    changeSlide(1);
                } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                    changeSlide(-1);
                }
            });

            // --- Touch/Swipe Support ---
            let touchStartY = 0;
            let touchEndY = 0;
            const minSwipeDistance = 50;

            document.addEventListener('touchstart', (e) => {
                touchStartY = e.changedTouches[0].screenY;
            }, { passive: true });

            document.addEventListener('touchend', (e) => {
                touchEndY = e.changedTouches[0].screenY;
                handleSwipe(e.target);
            }, { passive: true });

            function findScrollableParent(target) {
                // Priority: inner scroll areas, then active slide itself
                const inner = target.closest('.overflow-y-auto');
                if (inner) return inner;

                const active = slides[currentSlide];
                if (active && active.contains(target)) return active;

                return null;
            }

            function handleSwipe(target) {
                const distance = touchStartY - touchEndY;
                if (Math.abs(distance) <= minSwipeDistance) return;

                const scrollable = findScrollableParent(target);
                if (scrollable) {
                    const canScroll = scrollable.scrollHeight > scrollable.clientHeight + 2;
                    if (canScroll) {
                        const isAtTop = scrollable.scrollTop <= 0;
                        const isAtBottom = scrollable.scrollTop + scrollable.clientHeight >= scrollable.scrollHeight - 1;

                        if (distance > 0 && !isAtBottom) return; // swipe up, but can scroll down
                        if (distance < 0 && !isAtTop) return;    // swipe down, but can scroll up
                    }
                }

                if (distance > 0) {
                    changeSlide(1); // Swipe Up -> Next
                } else {
                    changeSlide(-1); // Swipe Down -> Prev
                }
            }

            // --- OSI Interactive Model Logic ---
            const osiData = {
    7: {
        title: "Прикладной (Application)",
        desc: "Точка входа. Взаимодействие человека и сети. Здесь генерируются данные для отправки.",
        tech: "HTTP, HTTPS, DNS, FTP, SMTP",
        pdu: "Данные (Data)",
        hw: "ПК, Смартфон (Приложения: Браузер, Skype, Outlook)",
        analogy: "Написание письма. Вы берете чистый лист бумаги и пишете: «Привет, как дела?». Это сама суть информации, которую вы хотите передать, понятная человеку.",
        threats: ["Фишинг", "Вирусы", "SQL-инъекции"],
        threat_analogy: "Мошенник просит вас в письме срочно выслать деньги или вкладывает в конверт ядовитый порошок (вирус)."
    },
    6: {
        title: "Представительский (Presentation)",
        desc: "Перевод и форматирование. Преобразование данных в универсальный формат (кодировка, сжатие, шифрование).",
        tech: "SSL/TLS, JPEG, ASCII, EBCDIC",
        pdu: "Данные (Data)",
        hw: "Шлюз, ПО (драйверы, кодеки)",
        analogy: "Перевод и шифр. Вы понимаете, что друг говорит только по-английски, и переводите текст. Чтобы никто чужой не прочитал, вы пишете шифром (шифрование). Лист складываете втрое (сжатие), чтобы он влез в конверт.",
        threats: ["SSL Stripping", "Подделка сертификатов"],
        threat_analogy: "Кто-то перехватил письмо, вскрыл конверт, перевел ваш шифр на обычный язык и прочитал содержимое."
    },
    5: {
        title: "Сеансовый (Session)",
        desc: "Управление диалогом. Установление, поддержание и разрыв связи между устройствами.",
        tech: "API, Sockets, RPC, SMB",
        pdu: "Данные (Data)",
        hw: "Шлюз, Брандмауэр",
        analogy: "Договоренность о встрече. Перед отправкой важного пакета вы звоните другу: «Ты сейчас дома? Я отправляю». Вы договариваетесь, что если связь прервется, вы начнете разговор заново.",
        threats: ["Session Hijacking (Перехват сессии)", "Brute Force"],
        threat_analogy: "Злоумышленник оглушил вас, взял трубку телефона и продолжил разговор с другом от вашего имени, а друг не заметил подмены."
    },
    4: {
        title: "Транспортный (Transport)",
        desc: "Надежность доставки и адресация процесса (порта). Гарантия, что данные дойдут без ошибок и в правильном порядке.",
        tech: "TCP (надежный), UDP (быстрый)",
        pdu: "Сегмент (Segment) / Датаграмма",
        hw: "Firewall (Брандмауэр), Балансировщик нагрузки",
        analogy: "Выбор способа отправки и имя получателя. TCP — это заказное письмо с уведомлением о вручении (гарантия). UDP — это просто кинуть открытку в ящик (быстро, но может потеряться). Вы пишете на конверте: «Лично в руки Ивану» (порт назначения).",
        threats: ["Сканирование портов", "SYN Flood (DDoS)"],
        threat_analogy: "Хулиганы завалили ваш почтовый ящик тысячами пустых конвертов, и вы не можете найти среди них настоящее письмо."
    },
    3: {
        title: "Сетевой (Network)",
        desc: "Маршрутизация и логическая адресация. Определение оптимального пути через глобальную сеть.",
        tech: "IP (IPv4, IPv6), ICMP, IPsec, IGMP",
        pdu: "Пакет (Packet)",
        hw: "Роутер (Маршрутизатор)",
        analogy: "Написание адреса на конверте. Вы пишете: «Страна, Город, Улица, Дом» (IP-адрес). Почтовая служба решает, как лучше везти: самолетом через океан или поездом, если самолеты не летают (маршрутизация).",
        threats: ["IP Spoofing", "Man-in-the-Middle (MitM)"],
        threat_analogy: "Злоумышленник поменял указатели на дорогах, и грузовик с почтой уехал в неизвестном направлени."
    },
    2: {
        title: "Канальный (Data Link)",
        desc: "Физическая адресация и доставка внутри одной локальной сети. Проверка ошибок передачи.",
        tech: "Ethernet, MAC, VLAN, Wi-Fi (802.11)",
        pdu: "Кадр (Frame)",
        hw: "Switch (Коммутатор), Сетевая карта (NIC)",
        analogy: "Локальная логистика. Письмо кладут в контейнер для конкретного грузовика. Водителю не важен адрес дома получателя в другой стране, ему важно довезти груз только до следующего сортировочного центра (MAC-адрес).",
        threats: ["MAC Spoofing", "ARP Poisoning", "VLAN Hopping"],
        threat_analogy: "Вор надел форму сотрудника почты (подменил MAC) и забрал контейнер с письмами, сказав, что отвезет их на склад."
    },
    1: {
        title: "Физический (Physical)",
        desc: "Передача «сырых» битов через физическую среду. Электрические сигналы, свет или радиоволны.",
        tech: "Медный кабель (RJ45), Оптоволокно, Радиоволны",
        pdu: "Бит (Bit)",
        hw: "Кабель, Hub (Концентратор), Повторитель",
        analogy: "Дорога и транспорт. Это сам асфальт, по которому едет грузовик, или провода, по которым бежит ток. Если мост разрушен (кабель перерезан), никакой, даже самый грамотно подписанный конверт никуда не попадет.",
        threats: ["Физическое повреждение кабеля", "Электромагнитные помехи", "Прослушка кабеля"],
        threat_analogy: "Диверсанты взорвали мост или перерезали тормозные шланги грузовику. Письмо уничтожено физически."
    }
};

            function setOsiLayer(layerNum) {
                // UI Update
                document.querySelectorAll('.osi-btn').forEach((btn) => {
                    btn.classList.remove('bg-cyber-neon/20', 'border-cyber-neon');
                    btn.classList.add('border-white/20');
                });

                const activeBtn = document.getElementById(`osi-btn-${layerNum}`);
                if (activeBtn) {
                    activeBtn.classList.remove('border-white/20');
                    activeBtn.classList.add('bg-cyber-neon/20', 'border-cyber-neon');
                }

                const data = osiData[layerNum];
                if (!data) return;

                document.getElementById('osi-layer-num').innerText = `L${layerNum}`;
                document.getElementById('osi-title').innerText = data.title;
                document.getElementById('osi-desc').innerText = data.desc;
                document.getElementById('osi-tech').innerText = data.tech;

                document.getElementById('osi-analogy').innerText = data.analogy;
                document.getElementById('osi-threat-analogy').innerText = data.threat_analogy;

                const threatsList = document.getElementById('osi-threats');
                threatsList.innerHTML = '';
                data.threats.forEach((threat) => {
                    const li = document.createElement('li');
                    li.innerText = threat;
                    threatsList.appendChild(li);
                });
            }

            document.querySelectorAll('[data-osi-layer]').forEach((btn) => {
                btn.addEventListener('click', () => {
                    const layer = parseInt(btn.dataset.osiLayer || '1', 10);
                    setOsiLayer(layer);
                });
            });

            // --- Chart.js Initialization ---
            let censorshipChart = null;
            function initCensorshipChart() {
                const canvas = document.getElementById('censorshipChart');
                if (!canvas || !window.Chart) return;

                const ctx = canvas.getContext('2d');
                if (!ctx) return;

                if (censorshipChart) {
                    censorshipChart.destroy();
                    censorshipChart = null;
                }

                censorshipChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['00:00', '00:10', '00:20', '00:30', '00:40', '00:50', '01:00'],
                        datasets: [
                            {
                                label: 'Обычный',
                                data: [100, 98, 100, 102, 99, 100, 101],
                                borderColor: '#888888',
                                borderDash: [5, 5],
                                tension: 0.4,
                                pointRadius: 0
                            },
                            {
                                label: 'Замедление',
                                data: [100, 95, 45, 30, 25, 30, 28],
                                borderColor: '#ff6b6b',
                                backgroundColor: 'rgba(255, 107, 107, 0.1)',
                                fill: true,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#e0e0e0', font: { size: 10 } } },
                            tooltip: { mode: 'index', intersect: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#bbbbbb', font: { size: 9 }, callback: (value) => value + ' Mb' }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { color: '#bbbbbb', font: { size: 9 } }
                            }
                        },
                        animation: {
                            duration: 2000,
                            easing: 'easeOutQuart'
                        }
                    }
                });
            }

            // --- Hard reset on reload/back-forward (start at slide 1 always) ---
            function hardResetToStart() {
                updateTotalIndicator();
                slides.forEach((s) => resetScrollInside(s));
                goToSlide(0, { resetActiveScroll: true });
                setOsiLayer(7);
                initCensorshipChart();

                // Extra tick for mobile browsers that ignore scrollTo during initial paint
                setTimeout(scrollPageToTop, 0);
                setTimeout(scrollPageToTop, 50);
            }

            // First run immediately (script is at the end of body)
            hardResetToStart();

            // Also handle BFCache restores
            window.addEventListener('pageshow', () => {
                hardResetToStart();
            });

        })();
    </script>
    </script>
</body>
</html>
